rule MAL_JLORAT_Apr_2023_1 : apt jlorat backdoor
{
    meta:
        description = "Detect JLORAT backdoor"
        author = "Arkbird_SOLG"
        date = "2023-04-24"
        reference = "https://securelist.com/tomiris-called-they-want-their-turla-malware-back/109552/"
        hash1 = "296599df29f4ffa9bf753ff9440032d912969d0bab6e3208ab88b350f9a83605"
        hash2 = "69bb729ff354cd9651f99a05f74f3ea20d483dc8e6e5838e4dd48858fd500d29"
        tlp = "Clear"
        adversary = "-"
    strings:
        $s1 = { 8b 8d 28 ff ff ff 8b 95 24 ff ff ff 89 e0 89 50 04 89 08 e8 [2] 00 00 89 85 20 ff ff ff eb 00 8b 8d 2c ff ff ff 8b 95 20 ff ff ff 89 e0 89 50 08 89 08 c7 40 04 00 00 00 00 e8 [2] 2e 00 83 }
        $s2 = { 8b 8d 74 ff ff ff 8b 95 70 ff ff ff 89 e0 89 85 60 ff ff ff 8d 75 80 89 70 1c 8d b5 7c ff ff ff 89 70 18 8d b5 78 ff ff ff 89 70 10 89 50 04 89 08 c7 40 14 ff ff ff ff c7 40 0c 01 00 00 00 c7 40 08 00 00 00 00 e8 [3] 00 83 ec 20 89 85 64 ff ff ff eb 00 8b 85 64 ff ff ff 89 45 c4 83 }
        $s3 = { 53 68 7e 66 04 80 57 ff 15 [3] 00 83 f8 ff 0f 84 59 01 00 00 8b 45 10 b9 10 00 00 00 ba 1c 00 00 00 83 38 00 0f 44 d1 83 c0 04 52 50 57 ff 15 [3] 00 83 f8 ff 74 22 c6 45 dc 04 c7 85 bc fe ff ff 00 00 00 00 53 68 7e 66 04 80 57 ff 15 [3] 00 83 f8 }
        $s4 = { 5c 50 72 6f 63 65 73 73 6f 72 28 5f 54 6f 74 61 6c 29 5c 25 20 50 72 6f 63 65 73 73 6f 72 20 54 69 6d 65 74 6f 74 5f 30 5c 50 72 6f 63 65 73 73 6f 72 28 29 5c 25 20 50 72 6f 63 65 73 73 6f 72 20 54 69 6d 65 }
    condition:
       uint16(0) == 0x5A4D and filesize > 900KB and all of ($s*) 
}
